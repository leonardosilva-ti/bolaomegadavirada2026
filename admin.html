<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Bol√£o Mega da Virada</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    #area-admin { display: none; text-align: center; }
    #jogos-lista { text-align: left; margin-top: 20px; }
    input, button { margin: 5px; }
  </style>
</head>
<body>
  <h1>√Årea Administrativa</h1>

  <div id="login">
    <p>Digite a senha de acesso:</p>
    <input type="password" id="senha" placeholder="Senha">
    <button id="btnEntrar">Entrar</button>
  </div>

  <div id="area-admin">
    <h2>Jogo Principal (9 n√∫meros)</h2>
    <input type="text" id="jogo9" placeholder="Ex: 01 05 12 18 25 30 42 50 57" style="width:80%">
    <button id="btnSalvarJogo9">Salvar</button>

    <h2>Participantes e Jogos</h2>
    <button id="btnCarregar">Carregar Dados</button>
    <div id="jogos-lista"></div>

    <h3>Excluir participante</h3>
    <input type="text" id="nomeExcluir" placeholder="Nome completo">
    <button id="btnExcluir">Excluir</button>

    <h2>Verifica√ß√£o de Resultados</h2>
    <input type="text" id="numsSorteados" placeholder="Ex: 01,02,10,25,37,59" style="width:60%">
    <button id="btnVerificar">Verificar Acertos</button>
    <div id="resultado"></div>

    <h2>Encerramento</h2>
    <button id="btnFechar">Fechar Bol√£o</button>
  </div>

  <script>
    const SENHA_ADMIN = "12345"; // üîí Altere aqui sua senha
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbylsOPklfzElA8ZYF7wYneORp5nWymkrnDzXhVK-onsnb9PXze16S50yVbu059g_w4tLA/exec";

    document.getElementById("btnEntrar").onclick = () => {
      const senha = document.getElementById("senha").value;
      if (senha === SENHA_ADMIN) {
        document.getElementById("login").style.display = "none";
        document.getElementById("area-admin").style.display = "block";
      } else {
        alert("Senha incorreta!");
      }
    };

    document.getElementById("btnCarregar").onclick = async () => {
      const res = await fetch(GOOGLE_SCRIPT_URL + "?action=get");
      const dados = await res.json();
      mostrarDados(dados);
    };

    function mostrarDados(dados) {
      const div = document.getElementById("jogos-lista");
      div.innerHTML = "";
      dados.forEach((linha, i) => {
        div.innerHTML += `<p><strong>${i + 1} - ${linha.nome}</strong> (${linha.telefone})<br>
          ${linha.jogos.join("<br>")}</p><hr>`;
      });
    }

    document.getElementById("btnExcluir").onclick = async () => {
      const nome = document.getElementById("nomeExcluir").value.trim();
      if (!nome) return alert("Informe o nome completo do participante.");
      await fetch(`${GOOGLE_SCRIPT_URL}?action=delete&nome=${encodeURIComponent(nome)}`);
      alert("Participante exclu√≠do (caso existisse).");
    };

    document.getElementById("btnSalvarJogo9").onclick = () => {
      const jogo = document.getElementById("jogo9").value.trim();
      if (jogo.split(" ").length !== 9) {
        alert("Digite exatamente 9 n√∫meros separados por espa√ßo.");
        return;
      }
      localStorage.setItem("jogo9", jogo);
      alert("Jogo de 9 n√∫meros salvo!");
    };

    document.getElementById("btnVerificar").onclick = async () => {
      const nums = document.getElementById("numsSorteados").value.trim();
      if (!nums) return alert("Digite os n√∫meros sorteados separados por v√≠rgula.");
      const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=verify&nums=${nums}`);
      const ganhadores = await res.json();
      const div = document.getElementById("resultado");
      if (ganhadores.length === 0) {
        div.innerHTML = "<p>Nenhum jogo com 4 ou mais acertos.</p>";
        return;
      }
      div.innerHTML = "<h3>Ganhadores:</h3>" + ganhadores.map(g => `
        <p><strong>${g.nome}</strong> (${g.telefone})<br>
        ${g.jogo}: ${g.numeros}<br>
        <strong>${g.acertos} acertos</strong></p>`).join("<hr>");
    };

    document.getElementById("btnFechar").onclick = () => {
      alert("Bol√£o encerrado! Exporte a planilha e envie os jogos a todos.");
    };
  </script>
</body>
</html>
