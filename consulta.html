<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Consulta - BolÃ£o da Sorte</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="site-header">Consulta de Jogos - BolÃ£o da Sorte</header>

  <main class="container">
    <!-- Consulta -->
    <section class="consulta-box">
      <h2>Consultar Jogos</h2>
      <div class="form-row">
        <input type="text" id="nomeConsulta" placeholder="Primeiro nome">
        <input type="text" id="telefoneConsulta" placeholder="Ãšltimos dÃ­gitos do telefone">
      </div>
      <button id="btnConsultar" class="primary">Consultar</button>
    </section>

    <hr>

    <!-- EstatÃ­sticas do BolÃ£o -->
    <section id="estatisticas" class="stats-container hidden">
      <div class="stats-card">
        <h4>Total de Jogos</h4>
        <p id="totalJogos">0</p>
      </div>
      <div class="stats-card">
        <h4>Participantes</h4>
        <p id="totalParticipantes">0</p>
      </div>
    </section>

    <!-- Jogo da Sorte -->
    <section id="jogoSorte" class="jogo-sorte-box hidden">
      <h2>ðŸŽ¯ Jogo da Sorte</h2>
      <div id="numerosSorte" class="jogo-sorte-numeros"></div>
    </section>

    <!-- Lista de Jogos -->
    <section id="todosJogos" class="todos-jogos hidden"></section>
  </main>

  <script>
    document.getElementById('btnConsultar').addEventListener('click', async () => {
      const nome = document.getElementById('nomeConsulta').value.trim().toLowerCase();
      const telefone = document.getElementById('telefoneConsulta').value.trim();

      if (!nome || !telefone) {
        alert('Por favor, preencha o nome e os Ãºltimos dÃ­gitos do telefone.');
        return;
      }

      try {
        const resp = await fetch(
          'https://script.google.com/macros/s/AKfycbxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx/exec?acao=consultar&nome=' +
          encodeURIComponent(nome) + '&telefone=' + encodeURIComponent(telefone)
        );
        const dados = await resp.json();

        if (!dados || dados.length === 0) {
          alert('Nenhum jogo encontrado para esse participante.');
          return;
        }

        // Mostra estatÃ­sticas e seÃ§Ãµes
        document.getElementById('estatisticas').classList.remove('hidden');
        document.getElementById('jogoSorte').classList.remove('hidden');
        document.getElementById('todosJogos').classList.remove('hidden');

        // EstatÃ­sticas
        document.getElementById('totalJogos').textContent = dados.length;
        const participantesUnicos = new Set(dados.map(j => j.nome));
        document.getElementById('totalParticipantes').textContent = participantesUnicos.size;

        // Jogo da Sorte (exemplo fixo â€” pode ser substituÃ­do pela API)
        const numerosSorte = [3, 12, 22, 35, 44, 56];
        const numerosDiv = document.getElementById('numerosSorte');
        numerosDiv.innerHTML = '';
        numerosSorte.forEach(num => {
          const span = document.createElement('span');
          span.textContent = num.toString().padStart(2, '0');
          numerosDiv.appendChild(span);
        });

        // Lista de jogos
        const lista = document.getElementById('todosJogos');
        lista.innerHTML = '';

        dados.forEach(jogo => {
          const div = document.createElement('div');
          div.className = 'jogo-item';
          div.innerHTML = `
            <h4>${jogo.nome}</h4>
            <div class="jogo-card">${[jogo.jogo1, jogo.jogo2, jogo.jogo3, jogo.jogo4, jogo.jogo5]
              .filter(Boolean)
              .map((nums, i) => `<p><strong>Jogo ${i+1}:</strong> ${nums}</p>`)
              .join('')}</div>
          `;
          lista.appendChild(div);
        });
      } catch (e) {
        console.error(e);
        alert('Erro ao consultar os jogos. Verifique sua conexÃ£o.');
      }
    });
  </script>
</body>
</html>
